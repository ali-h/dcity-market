<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NFT Sell Book - Ali H</title>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sscjs@latest/dist/ssc.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $(window).bind("load", function() {
      const ssc = new SSC('https://api.hive-engine.com/rpc');
      const getList = async () => {
        const book = [];
        let isPending = true;
        let offset = 0;
        while (isPending) {
          const list = await ssc.find('nftmarket',
            'CITYsellBook',
            {},
            1000,
            offset,
            []);
          list.forEach(el => book.push(el));
          if (list.length !== 1000) {
            isPending = false;
          }
          else offset += 1000;
        }
        const table = $("#table");
        book.forEach(data => {
          const timestamp = new Date(data.timestamp);
          const order = $("<tr>");
          order.append(`<td>${data.grouping.name}</td>`);
          order.append(`<td>${data.nftId}</td>`);
          order.append(`<td>${data.price}</td>`);
          order.append(`<td>${data.priceSymbol}</td>`);
          order.append(`<td>${data.account}</td>`);
          order.append(`<td>${timestamp.toLocaleTimeString()}, ${timestamp.toLocaleDateString()}</td>`);
          table.append(order);
        });
        $("span").remove()
        $("table").removeAttr("style");
      };
      getList();
    });
  </script>
</head>
<body>
  <span>loading</span>
  <table border="1" style="display: none;">
    <thead>
      <th>Name</th>
      <th>Id</th>
      <th>Price</th>
      <th>Symbol</th>
      <th>Account</th>
      <th>Time</th>
    </thead>
    <tbody id="table"></tbody>
  </table>
</body>
</html>